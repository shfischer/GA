<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick tour of GA • GA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour of GA">
<meta property="og:description" content="GA">
<meta property="og:image" content="https://github.com/luca-scr/GA/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/GA.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/luca-scr/GA">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A quick tour of GA</h1>
                        <h4 data-toc-skip class="author">Luca
Scrucca</h4>
            
            <h4 data-toc-skip class="date">18 Oct 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/luca-scr/GA/blob/HEAD/vignettes/GA.Rmd"><code>vignettes/GA.Rmd</code></a></small>
      <div class="hidden name"><code>GA.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Genetic algorithms (GAs) are stochastic search algorithms inspired by
the basic principles of biological evolution and natural selection. GAs
simulate the evolution of living organisms, where the fittest
individuals dominate over the weaker ones, by mimicking the biological
mechanisms of evolution, such as selection, crossover and mutation.</p>
<p>The R package <strong>GA</strong> provides a collection of general
purpose functions for optimization using genetic algorithms. The package
includes a flexible set of tools for implementing genetic algorithms
search in both the continuous and discrete case, whether constrained or
not. Users can easily define their own objective function depending on
the problem at hand. Several genetic operators are available and can be
combined to explore the best settings for the current task. Furthermore,
users can define new genetic operators and easily evaluate their
performances. Local search using general-purpose optimisation algorithms
can be applied stochastically to exploit interesting regions. GAs can be
run sequentially or in parallel, using an explicit master-slave
parallelisation or a coarse-grain islands approach.</p>
<p>This document gives a quick tour of <strong>GA</strong> (version
3.2.3) functionalities. It was written in R Markdown, using the <a href="https://cran.r-project.org/package=knitr" class="external-link">knitr</a> package for
production. Further details are provided in the papers Scrucca (2013)
and Scrucca (2017). See also <code><a href="https://github.com/luca-scr/GA/reference">help(package="GA")</a></code> for a list
of available functions and methods.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luca-scr.github.io/GA/" class="external-link">GA</a></span><span class="op">)</span></span>
<span><span class="co">##   ____    _    </span></span>
<span><span class="co">##  / ___|  / \     Genetic </span></span>
<span><span class="co">## | |  _  / _ \    Algorithms</span></span>
<span><span class="co">## | |_| |/ ___ \   </span></span>
<span><span class="co">##  \____/_/   \_\  version 3.2.3</span></span>
<span><span class="co">## Type 'citation("GA")' for citing this R package in publications.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-optimisation-in-one-dimension">Function optimisation in one dimension<a class="anchor" aria-label="anchor" href="#function-optimisation-in-one-dimension"></a>
</h2>
<p>Consider the function <span class="math inline">\(f(x) =
(x^2+x)\cos(x)\)</span> defined over the range <span class="math inline">\(-10 \le x \le 10\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">lbound</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">10</span>; <span class="va">ubound</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">f</span>, from <span class="op">=</span> <span class="va">lbound</span>, to <span class="op">=</span> <span class="va">ubound</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-2-1.svg" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, fitness <span class="op">=</span> <span class="va">f</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>th <span class="op">=</span> <span class="va">lbound</span><span class="op">)</span>, upper <span class="op">=</span> <span class="va">ubound</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  50 </span></span>
<span><span class="co">## Number of generations =  100 </span></span>
<span><span class="co">## Elitism               =  2 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##        th</span></span>
<span><span class="co">## lower -10</span></span>
<span><span class="co">## upper  10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 100 </span></span>
<span><span class="co">## Fitness function value = 47.70562 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##            th</span></span>
<span><span class="co">## [1,] 6.560507</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-2-2.svg" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">f</span>, from <span class="op">=</span> <span class="va">lbound</span>, to <span class="op">=</span> <span class="va">ubound</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span>, <span class="va">GA</span><span class="op">@</span><span class="va">fitnessValue</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-2-3.svg" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="function-optimisation-in-two-dimensions">Function optimisation in two dimensions<a class="anchor" aria-label="anchor" href="#function-optimisation-in-two-dimensions"></a>
</h2>
<p>Consider the <em>Rastrigin function</em>, a non-convex function often
used as a test problem for optimization algorithms because it is a
difficult problem due to its large number of local minima. In two
dimensions it is defined as <span class="math display">\[
f(x_1, x_2) = 20 + x_1^2 + x_2^2 - 10(\cos(2\pi x_1) + \cos(2\pi x_2)),
\]</span> with <span class="math inline">\(x_i \in [-5.12,
5.12]\)</span> for <span class="math inline">\(i=1,2\)</span>. It has a
global minimum at <span class="math inline">\((0,0)\)</span> where <span class="math inline">\(f(0,0) = 0\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rastrigin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fl">20</span> <span class="op">+</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="fl">5.12</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">Rastrigin</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/persp3D.html">persp3D</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span>, theta <span class="op">=</span> <span class="fl">50</span>, phi <span class="op">=</span> <span class="fl">20</span>, col.palette <span class="op">=</span> <span class="va">bl2gr.colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-3-1.svg" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span>, color.palette <span class="op">=</span> <span class="va">bl2gr.colors</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-3-2.svg" width="80%" style="display: block; margin: auto;"></p>
<p>A GA minimisation search is obtained as follows (note the minus sign
used in the definition of the local fitness function):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>         fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>         popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  50 </span></span>
<span><span class="co">## Number of generations =  1000 </span></span>
<span><span class="co">## Elitism               =  2 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##          x1    x2</span></span>
<span><span class="co">## lower -5.12 -5.12</span></span>
<span><span class="co">## upper  5.12  5.12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 364 </span></span>
<span><span class="co">## Fitness function value = -2.102512e-07 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##                x1            x2</span></span>
<span><span class="co">## [1,] -3.14136e-05 -8.541778e-06</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-4-1.svg" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span>, color.palette <span class="op">=</span> <span class="va">bl2gr.colors</span>, </span>
<span>  plot.axes <span class="op">=</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>; </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, </span>
<span>                       pch <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-5-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>The GA search process can be visualised by defining a monitoring
function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">monitor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span> </span>
<span><span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"iteration ="</span>, <span class="va">obj</span><span class="op">@</span><span class="va">iter</span><span class="op">)</span>, font.main <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">obj</span><span class="op">@</span><span class="va">population</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>         fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>         popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, </span>
<span>         monitor <span class="op">=</span> <span class="va">monitor</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-some-members-of-the-initial-population">Setting some members of the initial population<a class="anchor" aria-label="anchor" href="#setting-some-members-of-the-initial-population"></a>
</h2>
<p>The <code>suggestions</code> argument to <code><a href="../reference/ga.html">ga()</a></code> function
call can be used to provide a matrix of solutions to be included in the
initial population.</p>
<p>For example, consider the optimisation of the Rastrigin function
introduced above:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">suggestedSol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">1.5</span>,<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">0.5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">GA1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>          fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>          lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>          suggestions <span class="op">=</span> <span class="va">suggestedSol</span>,</span>
<span>          popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">GA1</span><span class="op">@</span><span class="va">population</span><span class="op">)</span></span>
<span><span class="co">##            [,1]      [,2]</span></span>
<span><span class="co">## [1,]  0.2000000  1.500000</span></span>
<span><span class="co">## [2,] -1.5000000  0.500000</span></span>
<span><span class="co">## [3,]  0.9173773  2.279250</span></span>
<span><span class="co">## [4,] -1.8294924 -4.883364</span></span>
<span><span class="co">## [5,] -4.9451095 -2.823999</span></span>
<span><span class="co">## [6,] -3.4600209 -1.178466</span></span></code></pre></div>
<p>As it can be seen, the first two solutions considered are those
provided, whereas the rest is filled randomly as usual. A full search
can be obtained as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>         fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>         suggestions <span class="op">=</span> <span class="va">suggestedSol</span>,</span>
<span>         popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  50 </span></span>
<span><span class="co">## Number of generations =  100 </span></span>
<span><span class="co">## Elitism               =  2 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##          x1    x2</span></span>
<span><span class="co">## lower -5.12 -5.12</span></span>
<span><span class="co">## upper  5.12  5.12</span></span>
<span><span class="co">## Suggestions = </span></span>
<span><span class="co">##     x1  x2</span></span>
<span><span class="co">## 1  0.2 1.5</span></span>
<span><span class="co">## 2 -1.5 0.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 100 </span></span>
<span><span class="co">## Fitness function value = -1.485033e-06 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##                x1           x2</span></span>
<span><span class="co">## [1,] 3.219976e-05 8.030266e-05</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="constrained-optimisation">Constrained optimisation<a class="anchor" aria-label="anchor" href="#constrained-optimisation"></a>
</h2>
<p>This example shows how to minimize an objective function subject to
nonlinear inequality constraints and bounds using GAs. Source: <a href="https://www.mathworks.it/it/help/gads/examples/constrained-minimization-using-the-genetic-algorithm.html" class="external-link uri">https://www.mathworks.it/it/help/gads/examples/constrained-minimization-using-the-genetic-algorithm.html</a></p>
<p>We want to minimize a simple function of two variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> <span class="math display">\[
\min_x f(x) = 100 (x_1^2 - x_2)^2 + (1 - x_1)^2;
\]</span> subject to the following nonlinear inequality constraints and
bounds:</p>
<ul>
<li>
<span class="math inline">\(x_1x_2 + x_1 - x_2 + 1.5 \le 0\)</span>
(<em>inequality constraint</em>),<br>
</li>
<li>
<span class="math inline">\(10 - x_1x_2 \le 0\)</span>
(<em>inequality constraint</em>),<br>
</li>
<li>
<span class="math inline">\(0 \le x_1 \le 1\)</span>
(<em>bounds</em>), and<br>
</li>
<li>
<span class="math inline">\(0 \le x_2 \le 13\)</span>
(<em>bounds</em>).</li>
</ul>
<p>The above fitness function is known as “cam” as described in L.C.W.
Dixon and G.P. Szego (eds.), <strong>Towards Global Optimisation
2</strong>, North-Holland, Amsterdam, 1978.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">{</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">}</span></span>
<span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>  <span class="op">{</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">}</span></span>
<span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>  <span class="op">{</span> <span class="fl">10</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">}</span></span></code></pre></div>
<p>Plot the function and the feasible regions (coloured areas):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngrid</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="va">ngrid</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13</span>, length <span class="op">=</span> <span class="va">ngrid</span><span class="op">)</span></span>
<span><span class="va">x12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="fu"><a href="../reference/palettes.html">bl2gr.colors</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"n"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">c1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">f</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>        nlevels <span class="op">=</span> <span class="fl">21</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-10-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>MATLAB solution:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8122</span>, <span class="fl">12.3104</span><span class="op">)</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] 13573.99</span></span></code></pre></div>
<p>However, note that the provided solution does not satisfy the
inequality constraints:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.00030688</span></span>
<span><span class="fu">c2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.00149312</span></span></code></pre></div>
<p>A GA solution can be obtained by defining a penalised fitness
function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitness</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">{</span> </span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>                         <span class="co"># we need to maximise -f(x)</span></span>
<span>  <span class="va">pen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span><span class="op">)</span>  <span class="co"># penalty term</span></span>
<span>  <span class="va">penalty1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">c1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="va">pen</span>       <span class="co"># penalisation for 1st inequality constraint</span></span>
<span>  <span class="va">penalty2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">c2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="va">pen</span>       <span class="co"># penalisation for 2nd inequality constraint</span></span>
<span>  <span class="va">f</span> <span class="op">-</span> <span class="va">penalty1</span> <span class="op">-</span> <span class="va">penalty2</span>            <span class="co"># fitness function value</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span><span class="st">"real-valued"</span>, fitness <span class="op">=</span> <span class="va">fitness</span>, </span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">13</span><span class="op">)</span>, </span>
<span>         <span class="co"># selection = GA:::gareal_lsSelection_R,</span></span>
<span>         maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">200</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  50 </span></span>
<span><span class="co">## Number of generations =  1000 </span></span>
<span><span class="co">## Elitism               =  2 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##       x1 x2</span></span>
<span><span class="co">## lower  0  0</span></span>
<span><span class="co">## upper  1 13</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 339 </span></span>
<span><span class="co">## Fitness function value = -13584.49 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##             x1       x2</span></span>
<span><span class="co">## [1,] 0.8120632 12.31468</span></span>
<span></span>
<span><span class="fu">fitness</span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">)</span></span>
<span><span class="co">## [1] -13584.49</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">)</span></span>
<span><span class="co">## [1] 13584.49</span></span>
<span><span class="fu">c1</span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.002319273</span></span>
<span><span class="fu">c2</span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.0003015433</span></span></code></pre></div>
<p>A graph showing the solution found is obtained as:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"n"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">c1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">c2</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>      col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x12</span>, <span class="fl">1</span>, <span class="va">f</span><span class="op">)</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>, </span>
<span>        nlevels <span class="op">=</span> <span class="fl">21</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">GA</span><span class="op">@</span><span class="va">solution</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, pch <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># GA solution</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-15-1.svg" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="integer-optimisation">Integer optimisation<a class="anchor" aria-label="anchor" href="#integer-optimisation"></a>
</h2>
<p>We consider here two approaches to integer optimisation via GAs, one
using binary GA search, and one using real-valued GA search. In both
cases an appropriate decoding function is used to convert the encoding
of the decision variables to the natural encoding of the problem.</p>
<p>Consider the <em>acceptance sampling</em> example described in
Scrucca (2013, Sec. 4.6). In essence, we must find the integers <span class="math inline">\(n\)</span> (sample size) and <span class="math inline">\(c\)</span> (acceptance number) that minimise a
loss function measuring the difference between the objective and the
achieved probability of acceptance of a lot. For more details see
Scrucca (2013, Sec. 4.6) and references therein.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AQL</span>   <span class="op">&lt;-</span> <span class="fl">0.01</span>; <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">LTPD</span>  <span class="op">&lt;-</span> <span class="fl">0.06</span>; <span class="va">beta</span>  <span class="op">&lt;-</span> <span class="fl">0.10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, type<span class="op">=</span><span class="st">"n"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"l"</span>, xaxs<span class="op">=</span><span class="st">"i"</span>, yaxs<span class="op">=</span><span class="st">"i"</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">"Prob. of acceptance"</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">AQL</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">AQL</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,<span class="fl">0</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">LTPD</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">beta</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LTPD</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span>,<span class="fl">0</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AQL</span>, <span class="va">LTPD</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">AQL</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">AQL</span>, <span class="st">", "</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">LTPD</span>, <span class="va">beta</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">LTPD</span>, <span class="st">", "</span>, <span class="va">beta</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-16-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p><strong>Binary search solution</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decode1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary2gray.html">gray2binary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary2decimal.html">binary2decimal</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">l1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="../reference/binary2decimal.html">binary2decimal</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">(</span><span class="va">l1</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">l1</span><span class="op">+</span><span class="va">l2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">c</span><span class="op">)</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fitness1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">{</span> </span>
<span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu">decode1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># sample size</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># acceptance number</span></span>
<span>  <span class="va">Pa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">n</span>, <span class="va">AQL</span><span class="op">)</span></span>
<span>  <span class="va">Pa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">n</span>, <span class="va">LTPD</span><span class="op">)</span></span>
<span>  <span class="va">Loss</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Pa1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pa2</span><span class="op">-</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">-</span><span class="va">Loss</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">200</span>                  <span class="co"># range of values to search</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary2decimal.html">decimal2binary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="co"># max number of bits requires</span></span>
<span><span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span>             <span class="co"># length of bits needed for encoding</span></span>
<span><span class="va">c</span>  <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>                   <span class="co"># range of values to search</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binary2decimal.html">decimal2binary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="co"># max number of bits requires</span></span>
<span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span>             <span class="co"># length of bits needed for encoding</span></span>
<span></span>
<span><span class="va">GA1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"binary"</span>, fitness <span class="op">=</span> <span class="va">fitness1</span>, </span>
<span>          nBits <span class="op">=</span> <span class="va">l1</span><span class="op">+</span><span class="va">l2</span>, </span>
<span>          popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA1</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  binary </span></span>
<span><span class="co">## Population size       =  100 </span></span>
<span><span class="co">## Number of generations =  1000 </span></span>
<span><span class="co">## Elitism               =  5 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 119 </span></span>
<span><span class="co">## Fitness function value = -5.049435e-05 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##      x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13</span></span>
<span><span class="co">## [1,]  0  1  1  1  1  1  0  0  1   0   0   1   1</span></span>
<span><span class="fu">decode1</span><span class="op">(</span><span class="va">GA1</span><span class="op">@</span><span class="va">solution</span><span class="op">)</span></span>
<span><span class="co">##  n  c </span></span>
<span><span class="co">## 87  2</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,type<span class="op">=</span><span class="st">"n"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"l"</span>, xaxs<span class="op">=</span><span class="st">"i"</span>, yaxs<span class="op">=</span><span class="st">"i"</span>, </span>
<span>     ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="va">a</span><span class="op">]</span><span class="op">)</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">AQL</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">AQL</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,<span class="fl">0</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">LTPD</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">beta</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LTPD</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span>,<span class="fl">0</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AQL</span>, <span class="va">LTPD</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">AQL</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">AQL</span>, <span class="st">", "</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">LTPD</span>, <span class="va">beta</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">LTPD</span>, <span class="st">", "</span>, <span class="va">beta</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, pos<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">87</span>; <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">Pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">87</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">Pa</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-18-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p><strong>Real-valued search solution</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decode2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>         <span class="co"># sample size</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># acceptance number</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">c</span><span class="op">)</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fitness2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">{</span> </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">decode2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># sample size</span></span>
<span>  <span class="va">c</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># acceptance number</span></span>
<span>  <span class="va">Pa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">n</span>, <span class="va">AQL</span><span class="op">)</span></span>
<span>  <span class="va">Pa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">pbinom</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">n</span>, <span class="va">LTPD</span><span class="op">)</span></span>
<span>  <span class="va">Loss</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Pa1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pa2</span><span class="op">-</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">Loss</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">GA2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, fitness <span class="op">=</span> <span class="va">fitness2</span>, </span>
<span>          lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">20</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,</span>
<span>          popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA2</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  100 </span></span>
<span><span class="co">## Number of generations =  1000 </span></span>
<span><span class="co">## Elitism               =  5 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##        x1 x2</span></span>
<span><span class="co">## lower   2  0</span></span>
<span><span class="co">## upper 201 21</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 146 </span></span>
<span><span class="co">## Fitness function value = -5.049435e-05 </span></span>
<span><span class="co">## Solutions = </span></span>
<span><span class="co">##            x1       x2</span></span>
<span><span class="co">## [1,] 87.10144 2.880684</span></span>
<span><span class="co">## [2,] 87.22478 2.914317</span></span>
<span><span class="co">## [3,] 87.94009 2.890449</span></span>
<span><span class="co">## [4,] 87.76376 2.869063</span></span>
<span><span class="co">## [5,] 87.79984 2.915490</span></span>
<span><span class="co">## [6,] 87.79108 2.903100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">GA2</span><span class="op">@</span><span class="va">solution</span>, <span class="fl">1</span>, <span class="va">decode2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##       n c</span></span>
<span><span class="co">## [1,] 87 2</span></span>
<span><span class="co">## [2,] 87 2</span></span>
<span><span class="co">## [3,] 87 2</span></span>
<span><span class="co">## [4,] 87 2</span></span>
<span><span class="co">## [5,] 87 2</span></span>
<span><span class="co">## [6,] 87 2</span></span></code></pre></div>
<p><strong>A comparison</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">systime</span> <span class="op">&lt;-</span> <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">niter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nrep</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Binary"</span>, <span class="st">"Real-valued"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nrep</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">GA1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"binary"</span>, fitness <span class="op">=</span> <span class="va">fitness1</span>, </span>
<span>                             nBits <span class="op">=</span> <span class="va">l1</span><span class="op">+</span><span class="va">l2</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">systime</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">t</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="va">GA1</span><span class="op">@</span><span class="va">fitnessValue</span>  </span>
<span>  <span class="va">niter</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="va">GA1</span><span class="op">@</span><span class="va">iter</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">GA2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, fitness <span class="op">=</span> <span class="va">fitness2</span>, </span>
<span>                             lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">20</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, </span>
<span>                             monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">systime</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">t</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="va">GA2</span><span class="op">@</span><span class="va">fitnessValue</span>  </span>
<span>  <span class="va">niter</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="va">GA2</span><span class="op">@</span><span class="va">iter</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">describe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">systime</span>, <span class="fl">2</span>, <span class="va">describe</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#               Mean      sd    0%   25%    50%    75%  100%</span></span>
<span><span class="co"># Binary      0.6902 0.20688 0.421 0.553 0.6340 0.7455 1.463</span></span>
<span><span class="co"># Real-valued 0.3251 0.07551 0.252 0.275 0.2995 0.3470 0.665</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">loss</span>, <span class="fl">2</span>, <span class="va">describe</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">1000</span></span>
<span><span class="co">#                Mean     sd      0%     25%     50%     75%   100%</span></span>
<span><span class="co"># Binary      0.09382 0.1919 0.05049 0.05049 0.05049 0.05049 1.5386</span></span>
<span><span class="co"># Real-valued 0.09600 0.1551 0.05049 0.05049 0.05049 0.05049 0.6193</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">niter</span>, <span class="fl">2</span>, <span class="va">describe</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#              Mean    sd  0% 25%   50%   75% 100%</span></span>
<span><span class="co"># Binary      160.8 48.31 100 129 146.0 172.2  337</span></span>
<span><span class="co"># Real-valued 122.5 27.99 100 104 110.5 130.0  246</span></span></code></pre></div>
<p>Based on this small example, real-valued GA search is about 50%
faster, converges in fewer iterations, and has the same accuracy as
binary search.</p>
</div>
<div class="section level2">
<h2 id="hybrid-gas">Hybrid GAs<a class="anchor" aria-label="anchor" href="#hybrid-gas"></a>
</h2>
<p>Hybrid Genetic Algorithms (HGAs) incorporate efficient local search
algorithms into GAs. In case of real-valued optimisation problems, the
<strong>GA</strong> package provides a simple way to start local
searches from GA solutions after a certain number of iterations, so
that, once a promising region is identified, the convergence to the
global optimum can be speed up.</p>
<p>The use of HGAs is controlled by the optional argument
<code>optim = TRUE</code> (by default is set to <code>FALSE</code>).
Local searches are executed using the base R function
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>, which makes available general-purpose optimisation
methods, such as Nelder–Mead, quasi-Newton with and without box
constraints, and conjugate-gradient algorithms. The local search method
to be used and other parameters are controlled with the optional
argument <code>optimArgs</code>, which must be a list with the following
structure and defaults:</p>
<pre><code><span><span class="va">optimArgs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>, </span>
<span>                 poptim <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                 pressel <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                 control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, maxit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>For more details see <code><a href="../reference/ga.html">help(ga)</a></code>.</p>
<p>Consider again the two-dimensional <em>Rastrigin function</em>
defined previously. A HGA search is obtained as follows:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>         fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>         popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span>,</span>
<span>         optim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Genetic Algorithm</span> ─────────────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Population size       =  50 </span></span>
<span><span class="co">## Number of generations =  1000 </span></span>
<span><span class="co">## Elitism               =  2 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##          x1    x2</span></span>
<span><span class="co">## lower -5.12 -5.12</span></span>
<span><span class="co">## upper  5.12  5.12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations             = 120 </span></span>
<span><span class="co">## Fitness function value = 0 </span></span>
<span><span class="co">## Solution = </span></span>
<span><span class="co">##      x1 x2</span></span>
<span><span class="co">## [1,]  0  0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-21-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>Note the improved solution obtained.</p>
</div>
<div class="section level2">
<h2 id="parallel-computing">Parallel computing<a class="anchor" aria-label="anchor" href="#parallel-computing"></a>
</h2>
<p>By default searches performed using the <strong>GA</strong> package
occur sequentially. In some cases, particularly when the evaluation of
the fitness function is time consuming, parallelisation of the search
algorithm may be able to speed up computing time. Starting with version
2.0, the <strong>GA</strong> package provides facilities for
implementing parallelisation of genetic algorithms.</p>
<p>Parallel computing with <strong>GA</strong> requires the following
packages to be installed: <strong>parallel</strong> (available in base
R), <a href="https://cran.r-project.org/package=doParallel" class="external-link">doParallel</a>, <a href="https://cran.r-project.org/package=foreach" class="external-link">foreach</a>, and <a href="https://cran.r-project.org/package=iterators" class="external-link">iterators</a>.</p>
<p>To use parallel computing with the <strong>GA</strong> package on a
<em>single machine with multiple cores</em> is simple as manipulating
the optional argument <code>parallel</code> in the <code><a href="../reference/ga.html">ga()</a></code>
function call.</p>
<p>The argument <code>parallel</code> can be a logical argument
specifying if parallel computing should be used (<code>TRUE</code>) or
not (<code>FALSE</code>, default) for evaluating the fitness function.
This argument could also be used to specify the number of cores to
employ; by default, this is taken from <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores()</a></code>
function in <strong>parallel</strong> package.</p>
<p>Two types of parallel functionality are implemented depending on
system OS: on Windows only <em>snow</em> type functionality is
available, while on POSIX operating systems, such as Unix, GNU/Linux,
and Mac OSX, both <em>snow</em> and <em>multicore</em> (default)
functionalities are available. In the latter case a string can be used
to specify which parallelisation method should be used.</p>
<p>In all cases described above, at the end of GA iterations the cluster
is automatically stopped by shutting down the workers.</p>
<p>Consider the following simple example where a pause statement is
introduced to simulate an expensive fitness function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luca-scr.github.io/GA/" class="external-link">GA</a></span><span class="op">)</span></span>
<span><span class="va">fitness</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rbenchmark.googlecode.com" class="external-link">rbenchmark</a></span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">benchmark</span><span class="op">(</span></span>
<span>  GA1 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>           fitness <span class="op">=</span> <span class="va">fitness</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span>,</span>
<span>  GA2 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>           fitness <span class="op">=</span> <span class="va">fitness</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           seed <span class="op">=</span> <span class="fl">12345</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  GA3 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>           fitness <span class="op">=</span> <span class="va">fitness</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           seed <span class="op">=</span> <span class="fl">12345</span>, parallel <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  GA4 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>           fitness <span class="op">=</span> <span class="va">fitness</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           seed <span class="op">=</span> <span class="fl">12345</span>, parallel <span class="op">=</span> <span class="st">"snow"</span><span class="op">)</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test"</span>, <span class="st">"replications"</span>, <span class="st">"elapsed"</span>, <span class="st">"relative"</span><span class="op">)</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"test"</span>, </span>
<span>  replications <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">average</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">average</span> <span class="op">&lt;-</span> <span class="va">elapsed</span><span class="op">/</span><span class="va">replications</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">##   test replications elapsed average relative</span></span>
<span><span class="co">## 1  GA1           10 565.075 56.5075    3.975</span></span>
<span><span class="co">## 2  GA2           10 142.174 14.2174    1.000</span></span>
<span><span class="co">## 3  GA3           10 263.285 26.3285    1.852</span></span>
<span><span class="co">## 4  GA4           10 155.777 15.5777    1.096</span></span></code></pre></div>
<p>The results above have been obtained on an iMac, Intel Core i5 at
2.8GHz, with 4 cores and 16 GB RAM, running OSX 10.11.</p>
<p>If a <em>cluster of multiple machines</em> is available,
<code><a href="../reference/ga.html">ga()</a></code> can be executed in parallel using all, or a subset of,
the cores available to the machines belonging to the cluster. However,
this option requires more work from the user, who needs to set up and
register a parallel back end.</p>
<p>For instance, suppose that we want to create a cluster of two
computers having IP addresses <code>141.250.100.1</code> and
<code>141.250.105.3</code>, respectively. For each computer we require 8
cores, so we aim at having a cluster of 16 cores evenly distributed on
the two machines. Note that communication between the master worker and
the cluster nodes is done via SSH, so you should configure ssh to use
password-less login. For more details see McCallum and Weston (2011,
Chapter 2).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"141.250.100.1"</span>, <span class="st">"141.250.105.3"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">workers</span>, type <span class="op">=</span> <span class="st">"PSOCK"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>The code above defines a vector of <code>workers</code> containing
the IP address for each node of the cluster. This is used by
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster()</a></code> to create a <em>PSOCK Snow cluster</em>
object named <code>cl</code>. At this point, objects and functions, but
also R packages, required during the evaluation of fitness function must
be <em>exported</em> along the nodes of the cluster. For example, the
following code export the vector <code>x</code>, the fitness function
<code>fun</code>, and load the R package <code>mclust</code>, on each
node of the socket cluster:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, varlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"fun"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterCall</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">library</span>, package <span class="op">=</span> <span class="st">"mclust"</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>At this point a <code><a href="../reference/ga.html">ga()</a></code> function call can be executed by
providing the argument <code>parallel = cl</code>. For instance:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>          fitness <span class="op">=</span> <span class="va">fitness</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">12345</span>, parallel <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>Note that in this case the cluster must be explicitly stopped with
the command:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="island-evolution">Island evolution<a class="anchor" aria-label="anchor" href="#island-evolution"></a>
</h2>
<p>GAs can be designed to evolve using an Island evolution approach.
Here the population is partitioned in a set of sub-populations (islands)
in which isolated GAs are executed on separated processor runs.
Occasionally, some individuals from an island migrate to another island,
thus allowing sub-populations to share genetic material</p>
<p>This approach is implemented in the <code><a href="../reference/gaisl.html">gaisl()</a></code> function,
which has the same input arguments as the <code><a href="../reference/ga.html">ga()</a></code> function,
with the addition of the following argument:</p>
<ul>
<li><p><code>numIslands</code>: an integer value specifying the number
of islands to use (by default is set to 4)</p></li>
<li><p><code>migrationRate</code>: a value in the range (0,1) which
gives the proportion of individuals that undergo migration between
islands in every exchange (by default equal to 0.10)</p></li>
<li><p><code>migrationInterval</code>: an integer value specifying the
number of iterations at which exchange of individuals takes place (by
default set at 10).</p></li>
</ul>
<p>Parallel computing is used by default in the Island evolution
approach. Hybridisation by local search is also available as discussed
previously.</p>
<p>As an example, consider again the two-dimensional <em>Rastrigin
function</em>. An Island GA search is obtained as follows:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gaisl.html">gaisl</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>, </span>
<span>            fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>, </span>
<span>            popSize <span class="op">=</span> <span class="fl">100</span>, </span>
<span>            maxiter <span class="op">=</span> <span class="fl">1000</span>, run <span class="op">=</span> <span class="fl">100</span>,</span>
<span>            numIslands <span class="op">=</span> <span class="fl">4</span>, </span>
<span>            migrationRate <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>            migrationInterval <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">GA</span><span class="op">)</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Islands Genetic Algorithm</span> ─────────── </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA settings: </span></span>
<span><span class="co">## Type                  =  real-valued </span></span>
<span><span class="co">## Number of islands     =  4 </span></span>
<span><span class="co">## Islands pop. size     =  25 </span></span>
<span><span class="co">## Migration rate        =  0.2 </span></span>
<span><span class="co">## Migration interval    =  50 </span></span>
<span><span class="co">## Elitism               =  1 </span></span>
<span><span class="co">## Crossover probability =  0.8 </span></span>
<span><span class="co">## Mutation probability  =  0.1 </span></span>
<span><span class="co">## Search domain = </span></span>
<span><span class="co">##          x1    x2</span></span>
<span><span class="co">## lower -5.12 -5.12</span></span>
<span><span class="co">## upper  5.12  5.12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## GA results: </span></span>
<span><span class="co">## Iterations              = 750 </span></span>
<span><span class="co">## Epochs                  = 15 </span></span>
<span><span class="co">## Fitness function values = -2.062144e-09 -2.062144e-09 -2.062144e-09 -2.062144e-09 </span></span>
<span><span class="co">## Solutions = </span></span>
<span><span class="co">##                x1          x2</span></span>
<span><span class="co">## [1,] 2.154279e-06 2.39862e-06</span></span>
<span><span class="co">## [2,] 2.154279e-06 2.39862e-06</span></span>
<span><span class="co">## [3,] 2.154279e-06 2.39862e-06</span></span>
<span><span class="co">## [4,] 2.154279e-06 2.39862e-06</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GA</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-29-1.svg" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="memoization">Memoization<a class="anchor" aria-label="anchor" href="#memoization"></a>
</h2>
<p>In certain circumstances, particularly with binary GAs, <a href="https://en.wikipedia.org/wiki/Memoization" class="external-link">memoization</a> can be
used to speed up calculations by using cached results. This is easily
obtained using the <a href="https://cran.r-project.org/package=memoise" class="external-link">memoise</a>
package.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fat</span>, package <span class="op">=</span> <span class="st">"UsingR"</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">body.fat.siri</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">neck</span> <span class="op">+</span> <span class="va">chest</span> <span class="op">+</span> <span class="va">abdomen</span> <span class="op">+</span></span>
<span>          <span class="va">hip</span> <span class="op">+</span> <span class="va">thigh</span> <span class="op">+</span> <span class="va">knee</span> <span class="op">+</span> <span class="va">ankle</span> <span class="op">+</span> <span class="va">bicep</span> <span class="op">+</span> <span class="va">forearm</span> <span class="op">+</span> <span class="va">wrist</span>, data <span class="op">=</span> <span class="va">fat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.response</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitness</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span><span class="op">)</span></span>
<span><span class="op">{</span> </span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>,<span class="va">string</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://memoise.r-lib.org" class="external-link">memoise</a></span><span class="op">)</span></span>
<span><span class="va">mfitness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://memoise.r-lib.org/reference/memoise.html" class="external-link">memoise</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://memoise.r-lib.org/reference/is.memoised.html" class="external-link">is.memoised</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="fu"><a href="https://memoise.r-lib.org/reference/is.memoised.html" class="external-link">is.memoised</a></span><span class="op">(</span><span class="va">mfitness</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rbenchmark.googlecode.com" class="external-link">rbenchmark</a></span><span class="op">)</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu">benchmark</span><span class="op">(</span></span>
<span>  GA1 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span><span class="st">"binary"</span>, fitness <span class="op">=</span> <span class="va">fitness</span>, nBits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>           popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, seed <span class="op">=</span> <span class="fl">1</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  GA2 <span class="op">=</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span><span class="st">"binary"</span>, fitness <span class="op">=</span> <span class="va">mfitness</span>, nBits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>           popSize <span class="op">=</span> <span class="fl">100</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, seed <span class="op">=</span> <span class="fl">1</span>, monitor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test"</span>, <span class="st">"replications"</span>, <span class="st">"elapsed"</span>, <span class="st">"relative"</span><span class="op">)</span>, </span>
<span>  replications <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">tab</span><span class="op">$</span><span class="va">average</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">elapsed</span><span class="op">/</span><span class="va">replications</span><span class="op">)</span></span>
<span><span class="va">tab</span></span>
<span><span class="co">##   test replications elapsed relative average</span></span>
<span><span class="co">## 1  GA1           10  59.071    5.673  5.9071</span></span>
<span><span class="co">## 2  GA2           10  10.413    1.000  1.0413</span></span>
<span></span>
<span><span class="co"># to clear cache use</span></span>
<span><span class="fu"><a href="https://memoise.r-lib.org/reference/forget.html" class="external-link">forget</a></span><span class="op">(</span><span class="va">mfitness</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="miscellanea">Miscellanea<a class="anchor" aria-label="anchor" href="#miscellanea"></a>
</h2>
<div class="section level3">
<h3 id="applying-a-post-fitness-function-evaluation">Applying a post-fitness function evaluation<a class="anchor" aria-label="anchor" href="#applying-a-post-fitness-function-evaluation"></a>
</h3>
<p>In some circumstances we may want to apply a specific procedure after
the evaluation of the fitness function but before applying the genetic
operators. The optional argument <code>postFitness</code> can be used
for this task.</p>
<p>In the <code><a href="../reference/ga.html">ga()</a></code> function call the argument
<code>postFitness</code> can be used to specify a user-defined function
which, if provided, receives the current ga-class object as input,
performs post fitness-evaluation steps, and then returns the (eventually
updated version of) input object that will be employed in the following
GA search.</p>
<p>As an example, consider to save the GA population at each iteration
steps to draw a graph of GA evolution. The following code implements the
idea:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rastrigin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fl">20</span> <span class="op">+</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">postfit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">pop</span> <span class="op">&lt;-</span> <span class="va">object</span><span class="op">@</span><span class="va">population</span></span>
<span>  <span class="co"># update info</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">".pop"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">".pop"</span>, <span class="cn">NULL</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">.pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">".pop"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">".pop"</span>, <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">.pop</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="co"># output the input ga object (this is needed!!)</span></span>
<span>  <span class="va">object</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">GA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ga.html">ga</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"real-valued"</span>,</span>
<span>         fitness <span class="op">=</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu">Rastrigin</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="op">-</span><span class="fl">5.12</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.12</span>, <span class="fl">5.12</span><span class="op">)</span>,</span>
<span>         popSize <span class="op">=</span> <span class="fl">50</span>, maxiter <span class="op">=</span> <span class="fl">100</span>, seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         postFitness <span class="op">=</span> <span class="va">postfit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">.pop</span>, max.level <span class="op">=</span> <span class="fl">1</span>, list.len <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## List of 100</span></span>
<span><span class="co">##  $ : num [1:50, 1:2] 4.45 -2.95 1.55 -3.83 -2.38 ...</span></span>
<span><span class="co">##  $ : num [1:50, 1:2] 3.117 -4.391 -4.101 -1.536 -0.868 ...</span></span>
<span><span class="co">##  $ : num [1:50, 1:2] -0.1864 -0.7638 -0.0599 1.45 -1.7403 ...</span></span>
<span><span class="co">##  $ : num [1:50, 1:2] 0.632 0.111 0.944 -0.186 -0.925 ...</span></span>
<span><span class="co">##  $ : num [1:50, 1:2] -0.998 -1.055 -0.361 1.032 -1.154 ...</span></span>
<span><span class="co">##   [list output truncated]</span></span>
<span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.12</span>, <span class="fl">5.12</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">Rastrigin</span><span class="op">)</span></span>
<span><span class="va">iter_to_show</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>    mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span>, <span class="fl">0</span><span class="op">)</span>, tck <span class="op">=</span> <span class="op">-</span><span class="fl">.01</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">iter_to_show</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">f</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Iter ="</span>, <span class="va">iter_to_show</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">.pop</span><span class="op">[[</span><span class="va">iter_to_show</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="GA_files/figure-html/unnamed-chunk-31-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>McCallum, E. and Weston, S. (2011) <em>Parallel R</em>. O’Reilly
Media.</p>
<p>Scrucca, L. (2013) GA: A Package for Genetic Algorithms in R.
<em>Journal of Statistical Software</em>, 53/4, 1-37. <a href="https://doi.org/10.18637/jss.v053.i04" class="external-link uri">https://doi.org/10.18637/jss.v053.i04</a></p>
<p>Scrucca, L. (2017) On some extensions to GA package: hybrid
optimisation, parallelisation and islands evolution. <em>The R
Journal</em>, 9/1, 187–206. <a href="https://doi.org/10.32614/RJ-2017-008" class="external-link uri">https://doi.org/10.32614/RJ-2017-008</a></p>
<hr>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur ... 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] GA_3.2.3         iterators_1.0.14 foreach_1.5.2    knitr_1.40      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] Rcpp_1.0.9       rstudioapi_0.14  magrittr_2.0.3   R6_2.5.1        </span></span>
<span><span class="co">##  [5] rlang_1.0.6      fastmap_1.1.0    highr_0.9        stringr_1.4.1   </span></span>
<span><span class="co">##  [9] tools_4.2.1      xfun_0.33        cli_3.4.1        jquerylib_0.1.4 </span></span>
<span><span class="co">## [13] htmltools_0.5.3  yaml_2.3.5       digest_0.6.29    rprojroot_2.0.3 </span></span>
<span><span class="co">## [17] crayon_1.5.2     pkgdown_2.0.6    purrr_0.3.5      sass_0.4.2      </span></span>
<span><span class="co">## [21] fs_1.5.2         codetools_0.2-18 memoise_2.0.1    cachem_1.0.6    </span></span>
<span><span class="co">## [25] evaluate_0.17    rmarkdown_2.17   stringi_1.7.8    compiler_4.2.1  </span></span>
<span><span class="co">## [29] bslib_0.4.0      desc_1.4.2       jsonlite_1.8.2</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.stat.unipg.it/luca" class="external-link">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
